
- 낙관적 락과 비관적 락은 데이터베이스 [[트랜잭션(Transaction)]]] 동시성 제어를 위한 주요 기법이다. 


### 낙관적 락

- 데이터 충돌이 적을 것으로 가정하고 데이터를 읽을 때 락을 설정하지 않음.
- 트랜잭션이 데이터를 수정할때 충돌이 발생하지 않았는지 확인하는 방식.
- 트랜잭션 커밋 시점에 데이터가 변경되었는지 검사함.
- 보통 version 과 같은 별도의 컬럼을 사용해서 데이터가 변경되었는지 확인.

### 비관적 락

- 데이터 충돌이 많을것으로 가정하고 트랜잭션이 시작될 때 [[공유락 , 베타락]]을 설정해서 다른 트랜잭션이 해당 데이터에 접근하지 못하도록 하는 방식.
- 충돌 자체를 사전에 방지함.

### 차이점?

- 충돌 가능성
- 데이터베이스 락 사용 여부
- 성능 차이
	- 낙관적 락은 락을 설정하지 않기 때문에 성능은 더 좋을 수 있음 
	- 그러나 충돌이 발생할경우 롤백하거나 재시도 처리를 해야해서 꼭 좋은건 아님.

|항목|낙관적 락|비관적 락|
|---|---|---|
|**충돌 가정**|낮음|높음|
|**락 사용 시점**|커밋 시점에 검사|데이터 접근 시 바로 락 설정|
|**성능**|락 오버헤드 없음 → 성능 좋음 (충돌 적은 경우)|락 관리 비용 발생 → 성능 저하 우려|
|**충돌 발생 시**|롤백 및 재시도|충돌 자체가 거의 없음|

> [!note] 결론
> 낙관적 락은 충돌이 발생하면 해결하는 방식
> 비관적 락은 애초에 충돌을 방지하는 방식

>[!important] 언제 어떤 락을 사용하는게 좋을까?
>충돌 가능성이 많다고 생각하는 경우는 비관적 락
>별로 없다고 생각이 되는경우에는 낙관적 락
