
### Thread Safe 란?

- 여러 스레드가 동시에 어떤 코드나 자원에 접근해도 데이터의 일관성과 정확성이 깨지지 않음을 보장하는 말.
- 동시에 접속해도 데이터 문제 없다! 이말. 

- 이 Thread Safe 는 여러 스레드가 공유하는 자원을 다루기에 필수적이다. 


### Thread Safe를 보장하기 위해 어떻게??

- 상호배제 
	- 오직 하나만 접근하도록. 동시에 안됨.
	- 세마포어, 뮤텍스, 락
- 원자적 연산
	- 여러 연산을 묶어서 중간에 다른 스레드가 끼어들 수 없게 만들어버림. 
- 스레드 로컬 저장소
	- 스레드가 독립적인 데이터 복사본을 가지게해서 원천 차단. 
	- 그냥 복사한다는것. 
- 불변객체



### Peterson 알고리즘과 한계점

- peterson 알고리즘은 두개의 스레드가 공유자원에 대한 상호배제를 보장하기위해 설계된 소프트웨어 알고리즘. 
- flog 배열과 turn 변수를 사용해서 임계영역 진입을 제어. 

#### 한계점? 

- 3개 이상의 스레드에는 적용이 안된다고함. (딱 2개만 가능)
- 임계영역에 진입하려는 스레드가 계속해서 CPU를 사용해서 조건을 확인하게됨. 
	- CPU 자원을 비효율적으로 낭비. 
- 현대의 복잡한 CPU 아키텍처에서는 메모리 접근 순서가 변경되어서 알고리즘이 예상대로 작동하지 않을 수 있음. 


### Race Condition 이란?

- 여러 스레드가 동시에 공유자원에 접근할때 순서에 따라 결과가 달라지는 상태.
	- 그냥 공유자원에 접근했을때 문제가 생기는 문제를 Rece Condition


### thread Safe 락 말고 구현방법?

- 락은 성능 저하, 교착상태를 유발할 수 있음. 

- 위에서 말한거 동일. 
	- 하나로 묶어서 도중에 끼어들지 못하게 하기.
	- 독립적인 복사본을 만들어서 원천 차단. 
	- 객체 자체를 변경 불가능하게 만들어버리기.