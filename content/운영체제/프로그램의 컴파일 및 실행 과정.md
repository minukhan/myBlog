

##### 프로그램이 소스코드에서 실행파일로 변경되고 실제 메모리에 올라가기까지 과정은 전처리 과정을 거친다. 


![](https://i.imgur.com/LP9sPHv.png)


- 1단계 전처리. 
	-  #include 같은 전처리 지시문을 먼저 처리한다. 
	-  주석을 제거하고, 헤더 파일을 포함해서 실제 코드로 치환하여 컴파일 하기 쉽게 만듬.
- 2단계 컴파일
	- 전처리된 소스코드를 어셈블리어로 변환. 
	- 다양한 분석, 최적화를 통해서 문법 오류를 잡고 효율적인 코드를 생성
- 3단계 어셈블리
	- 기계어로 변환한다. 결과물로 오브젝트 파일이 생성된다. 
	- 이 파일에는 코드와 데이터가 포함되어있지만 완전한 실행파일은 아님.
-  4단계 링킹
	- 여러개의 오브젝트 파일과 프로그램에서 사용한 라이브러리 파일을 합쳐서 실행파일을 만듬
	- 함수 호출할때 어떤 코드로 점프해야하는지 등의 주소를 결정하고 연결함. 
- 5단계 : 로딩
	- 실행파일이 실행되면 로더가 이 파일을 메모리에 적재한다. CPU를 할당해서 프로그램이 실행.

### 자바에서의 컴파일 및 실행과정 

- 자바에서 소스코드가 실행될때 까지는 다른 언어랑은 다르다. 
	- 여기서 핵심은 JVM 의 존재. (자바 가상 머신)

- 1단계 컴파일
	- 개발자가 작성한 자바 소스 코드를 자바 컴파일러를 이용해서 컴파일한다. 
	-  -> 자바 바이트코드로 변환된 클래스 파일이 생성된다. 이 코드는 JVM이 이해할 수 있는 중간언어. 
- 2단계 로딩 
	- 프로그램을 실행하면 JVM 이 구동된다. 
	- JVM 안에 있는 클래스 로더가 프로그램 파일을 찾아서 메모리에 적재시킨다. 
- 3단계 링킹
	- 클래스 로더가 불러온 바이트코드를 검증하고, 필요한 메모리를 할당. 
	- 심볼릭 레퍼런스(기호 참조)를 실제 메모리 주소로 연결한다. 
- 4단계 초기화
	- 클래스 변수들을 지정된 값으로 초기화한다. 
	- static 초기화 블록을 실행한다. 
- 5단계 실행
	- 실행 엔진이 메모리에 올라온 바이트 코드를 한줄씩 해석하거나 실시간으로 네이티브 코드로 컴파일하여 실행한다. 

###  링커와 로더의 차이? 

- 링커와 로더는 수행하는 작업과 시점이 다르다. 
- 링커 : 컴파일 타임에 동작 
	- 하나의 실행파일로 만드는 역할. 
- 로더 : 런타임에 동작 
	- 실제 메모리에 실행파일을 올리고 운영체제가 프로그램을 실행할 수 있도록 준비하는 역할을 해준다. 

### 컴파일 언어와 인터프리터 언어?

- 가장 큰 차이는 실행 방식과 시점에 있다. 

- 컴파일 언어
	- 실행 전에 기계어로 번역하여 실행파일을 만든다. 
	- 이미 기계어로 번역되어있어서 실행 속도가 매우 빠르다. 하지만 매번 컴파일 해야하므로 개발속도가 느리다. 
- 인터프리터 언어 
	- 특정 시점에 코드를 한줄씩 읽어서 해석하고 바로 실행한다. 
	- 수정 즉시 실행이 가능해서 개발이 빠름. 그러나 매번 번역과정을 거치므로 느리다. 


### JIT( Just-in-Time )

- JIT 컴파일은 컴파일 언어의 빠른 속도와, 인터프리터 언어의 플랫폼 독립성이라는 장점을 결합한 방식. 
- 작동방식
	- 처음에는 인터프리터 방식으로 코드를 실행한다. 
	- 근데 여기서 자주 사용되는 코드(핫스팟)이 발견되면 그 부분만 실행시점에 컴파일해서 기계어로 변환한다. (그냥 자주 사용되는거는 미리 바꿔놓기)
	- 그렇게 컴파일된 코드는 캐시에 저장해두고 다음에는 번역 없이 캐시에서 꺼내 실행.

	- 캐시 히트가 높다면 기존 인터페이스 방식보다 훨씬 빠른 성능을 낼 수 있음. 
	- 실시간으로 컴파일하는 과정에서 오버헤드, 컴파일된 코드를 저장할 추가 메모리가 필요

	##### JAVA 가 여기에 해당된다. 



#### JAVA 컴파일 및 실행과정 설명해라?

1. 프로그램을 자바 컴파일러가 컴파일한다.
2. 그러면 바이트코드로 바뀜. 
3. JVM을 실행한다.
4. 클래스 로더가 로딩한다. (프로그램 메모리에 적재)
5. 인터프리터가 초기에 실행한다.
6. 이떄 JIT 컴파일러가 핫스팟을 네이티브 코드로 최적화한다.
7. 그러면 그 코드는 빠르게 수행 가능. 


### Python 구현체와 Java의 관계

- 파이썬은 언어일 뿐, 실제 구동하는 소프트웨어는 여러종류가 있다. 
- 이를 구현체라고 부르면서 각각 다른 특징과 실행 방식을 가짐. 

##### CPython 

- C언어로 작성된 파이썬의 표준 구현체. 우리가 흔히 가리키는 파이썬.
- C와 마찬가지로 소스코드를 바이트코드로 컴파일하고 PVM(인터프리터) 가 이를 실행시킨다. 
- 가장 널리 사용되고 호환성 뛰어남. C로 만든 수많은 라이브러리 사용가능. 

##### Jython

- 자바로 작성된 파이썬 구현체. 
- 자바 바이트코드로 컴파일, 후 자바 가상머신(JVM)위에서 실행된다. 
- 자바 플랫폼 위에서 동작하므로 자바의 라이브러리 가능. 

##### PyPy

- RPython 이라는 파이썬의 서브셋으로 작성된 파이썬 구현체.
- 성능 향상에 초점을 맞추고 있다. 
- 실행방식?
	- JIT 컴파일러를 내장하고 있다. 코드를 실행하면서 자주 쓰이는 부분을 기계어로 변환함. 
	- CPython 보다 훨씬 빠르다. 
	- 일부 C 라이브러리와의 호환성 문제가 있을 수 있다. 



### 로더와 fork, exec() 시스템 콜의 관계?

- 로더는 독립적인 프로그램이 아니라 exec() ( 덮어씌우는 ) 계역의 시스템 콜이 호출될때 커널에 의해 실행된다. 


- fork() : 실행중인 프로세스를 복제해서 자식 프로세스를 만듬. 이때 자식 프로세스는 모든것을 물려받음. 
- exec() : 프로세스를 복제하는게 아니라 , 새로운 프로그램을 덮어씌누는 것. 기존의 코드는 사라짐. 

##### 여기서 로더의 역할?

- exce() 시스템 콜이 운영체제 커널을 호출하면 커널 내의 로더가 활성화된다. 
- 로더는 실행파일을 읽어서 해당 파일의 코드와 데이터를 자식 메모리 공간에 적재하고 덮어씌운다. 

- 그러니까 로더가 메모리에 적재하는 역할을 하자나. 그 역할은 exce() 할때 일어남. 